# ============================================
# WORKFLOW DEMO - Cáº¤U TRÃšC 2 JOBS
# Job 1 fail â†’ Job 2 KHÃ”NG cháº¡y
# ============================================

name: Demo CI/CD Structure

# ğŸ“Œ TRIGGER - Khi nÃ o cháº¡y?
on:
  push:
    branches: [main]
  workflow_dispatch:  # Cho phÃ©p cháº¡y thá»§ cÃ´ng

# ğŸ“Œ BIáº¾N MÃ”I TRÆ¯á»œNG CHUNG
env:
  PROJECT_NAME: "Demo Project"

# ============================================
# DANH SÃCH JOBS
# ============================================
jobs:

  # ----------------------------------------
  # JOB 1: TEST
  # ----------------------------------------
  test:
    name: ğŸ§ª Job 1 - Cháº¡y Tests
    runs-on: ubuntu-latest
    timeout-minutes: 10

    steps:
      # Step 1: Checkout code
      - name: ğŸ“¥ Step 1 - Checkout code
        run: echo "Äang checkout code tá»« repository..."

      # Step 2: CÃ i Ä‘áº·t dependencies
      - name: ğŸ“¦ Step 2 - Install dependencies
        run: |
          echo "Äang cÃ i Ä‘áº·t dependencies..."
          echo "npm install"

      # Step 3: Cháº¡y test
      - name: ğŸ§ª Step 3 - Run tests
        run: |
          echo "Äang cháº¡y tests..."
          echo "Browser: Chrome"
          echo ""
          echo "âœ… Táº¥t cáº£ tests PASSED!"
          exit 1

  # ----------------------------------------
  # JOB 2: DEPLOY
  # âš ï¸ CHá»ˆ CHáº Y KHI JOB 1 THÃ€NH CÃ”NG
  # ----------------------------------------
  deploy:
    name: ğŸš€ Job 2 - Deploy
    runs-on: ubuntu-latest
    needs: test  # â† Chá» job "test" hoÃ n thÃ nh

    steps:
      - name: ğŸ—ï¸ Step 1 - Build project
        run: echo "Äang build project..."

      - name: ğŸš€ Step 2 - Deploy lÃªn server
        run: |
          echo "Äang deploy..."
          echo "Project: ${{ env.PROJECT_NAME }}"
          echo ""
          echo "âœ… Deploy thÃ nh cÃ´ng!"

      - name: ğŸ“§ Step 3 - ThÃ´ng bÃ¡o hoÃ n táº¥t
        run: |
          echo "=========================================="
          echo "ğŸ‰ WORKFLOW HOÃ€N Táº¤T!"
          echo "=========================================="
          echo "NgÆ°á»i trigger: ${{ github.actor }}"
          echo "Branch: ${{ github.ref_name }}"
          echo "=========================================="